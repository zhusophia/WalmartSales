{
  "articles": [
    {
      "path": "about.html",
      "title": "About this site",
      "description": "Some additional details about the website",
      "author": [],
      "contents": "\r\n\r\n\r\n\r\n",
      "last_modified": "2024-07-07T14:36:25-04:00"
    },
    {
      "path": "index.html",
      "title": "Weekly Walmart Sales Analysis",
      "description": "Utilizing SQL, R, and Python to analyze Walmart sales.\n",
      "author": [],
      "contents": "\r\nWelcome\r\nThis project is currently being re-written. There are major changes in progress. First, I am looking to include more statistical analysis on how sales correlate with every factor, which means that the code and analysis of insights will be updated on a daily basis. Second, I am changing the format of this report to be more similar to a business case study. Thus, sections are being reorganized and contain imperfect writing. Third, because of the following changes, the beautification of charts and tables may not be the main priority. Please proceed with this in mind.\r\nFor a more polished (but less relevant and more informal case study) to showcase my data analysis skills and interest in psychology, please click here!\r\nIntroduction\r\nThis project focuses on analyzing raw data from this dataset, which tracks the weekly sales of 45 Walmart stores over 2 years! It also tracks external factors like whether the week contained a holiday, the CPI, and the unemployment rate of the region.\r\nFirst, the data is cleaned using pandas as we want to make sure that this data is easy to deal with. The primary goal of cleaning is to standardize the data by rounding values and removing missing values.\r\n\r\n\r\nShow Python code\r\n#import \r\nimport pandas as pd\r\ndf = pd.read_csv('Walmart_sales.csv', parse_dates=['Date'], dayfirst=False)\r\n\r\n#sort by store number and then date\r\ndf.sort_values(by=['Store', 'Date'])\r\n\r\n#standarize dates to mm-dd-yyyy\r\ndf['Date'] = pd.to_datetime(df['Date'], format='%d-%m-%Y').dt.strftime('%m-%d-%Y')\r\n\r\n#rounding data \r\ndf.round({'Weekly_Sales':2, 'Temperature':0, 'Fuel_Price':2, 'CPI':3, 'Unemployment':3})\r\n\r\n#removing missing values\r\ndf.dropna\r\n\r\n#create cleaned csv\r\ndf.to_csv('./WalmartSalesClean.csv')\r\n\r\nAfter cleaning, the data appears like so:\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAnalysis\r\nNow that the data has been cleaned, we can use SQL and R to explore this data.\r\nHow do weekly sales vary by store and by year?\r\nFirst, weekly sales data is analyzed without taking the other factors into consideration.\r\nWe can identify the stores with the highest sales:\r\n\r\n\r\nShow SQL code\r\nSELECT Store, sum(CAST(Weekly_Sales AS FLOAT)) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Store\r\nORDER BY Weekly_Sales\r\n\r\n\r\n\r\n\r\nIt seems like store 33, 44, and 5 have the least amount of sales, while store 20, 4, and 14 have the most.\r\n\r\n\r\nShow SQL code\r\nSELECT TOP 3 Store, sum(Weekly_Sales) AS Weekly_Sales, avg(Temperature) AS Temperature, \r\navg(CPI) AS CPI, avg(Fuel_Price) AS Fuel_Price, avg(Unemployment) AS Unemployment\r\nFROM WalmartSalesClean\r\nGROUP BY Store\r\nORDER BY Weekly_Sales\r\n\r\n\r\n\r\nTable 1: Highest Unemployment\r\n\r\n\r\nStore\r\n\r\n\r\nWeekly_Sales\r\n\r\n\r\nTemperature\r\n\r\n\r\nFuel_Price\r\n\r\n\r\nCPI\r\n\r\n\r\nUnemployment\r\n\r\n\r\n5\r\n\r\n\r\n45475689\r\n\r\n\r\n69.41014\r\n\r\n\r\n3.219699\r\n\r\n\r\n216.5656\r\n\r\n\r\n6.295406\r\n\r\n\r\n44\r\n\r\n\r\n43293088\r\n\r\n\r\n53.69713\r\n\r\n\r\n3.286147\r\n\r\n\r\n128.6797\r\n\r\n\r\n6.735622\r\n\r\n\r\n33\r\n\r\n\r\n37160222\r\n\r\n\r\n76.72818\r\n\r\n\r\n3.575923\r\n\r\n\r\n128.6797\r\n\r\n\r\n8.533154\r\n\r\n\r\n\r\n\r\nShow SQL code\r\nSELECT TOP 3 Store, sum(Weekly_Sales) AS Weekly_Sales, avg(Temperature) AS Temperature, \r\navg(CPI) AS CPI, avg(Fuel_Price) AS Fuel_Price, avg(Unemployment) AS Unemployment\r\nFROM WalmartSalesClean\r\nGROUP BY Store\r\nORDER BY Weekly_Sales desc\r\n\r\n\r\n\r\nTable 2: Lowest Unemployment\r\n\r\n\r\nStore\r\n\r\n\r\nWeekly_Sales\r\n\r\n\r\nTemperature\r\n\r\n\r\nFuel_Price\r\n\r\n\r\nCPI\r\n\r\n\r\nUnemployment\r\n\r\n\r\n14\r\n\r\n\r\n288999911\r\n\r\n\r\n57.79098\r\n\r\n\r\n3.417608\r\n\r\n\r\n186.2857\r\n\r\n\r\n8.648748\r\n\r\n\r\n4\r\n\r\n\r\n299543953\r\n\r\n\r\n62.25336\r\n\r\n\r\n3.216972\r\n\r\n\r\n128.6797\r\n\r\n\r\n5.964692\r\n\r\n\r\n20\r\n\r\n\r\n301397792\r\n\r\n\r\n55.45140\r\n\r\n\r\n3.417608\r\n\r\n\r\n209.0381\r\n\r\n\r\n7.371413\r\n\r\n\r\nHowever, there doesn’t seem to be an easily identifiable correlation between sales and the factors (e.g. unemployment, temperature, etc.). Further analysis must be conducted to determine the relationship between these variables.\r\nWe can also see how Walmart sales varied from month to month.\r\n\r\n\r\n\r\nThere always seems to be a spike in December and a low in January. The high in December is likely caused by the holiday season, as consumers commonly buy large quantities of food, drinks, and gifts. The low in January could be explained by people saving because of New Year’s resolutions or ‘No-Spend’ January – trends that emphasize saving money. Consumers may also have less money after the December spending.\r\nThis graph also emphasizes the cyclic nature of consumer spending. The pattern is very consistent across the two years.\r\nDo holidays generate more sales? Which holidays affect weekly sales the most?\r\nHolidays are notorious for driving sales since Walmart often runs promotional markdown events to incentivize purchases when consumers are celebrating. Clearly, it works.\r\n\r\n\r\nShow SQL code\r\nSELECT Holiday_Flag, avg(Weekly_Sales) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Holiday_Flag\r\n\r\n\r\n\r\n\r\nHolidays can be narrowed into a few specific categories. When looking at the data, the below weeks are deemed ‘Holiday Weeks’.\r\n\r\n\r\nShow SQL code\r\nSELECT Holiday_Flag, avg(CAST(Weekly_Sales AS FLOAT)) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Holiday_Flag\r\n\r\n\r\n\r\n\r\n\r\nThe (repeating) holidays that appear in this data are:\r\nSuper Bowl (Feb 9th)\r\nLabor Day (Sept 10th)\r\nThanksgiving (Nov 26th)\r\nChristmas and Hanukkah (Dec 31th)\r\nWith these holidays, it is implied that the curator of data would have been American and this data could have been taken from American stores. However, the geographical location of these stores are not contained within the data set, so we should be wary of this assumption.\r\nFirst, the days had the highest profit should be examined:\r\n\r\n\r\nShow SQL code\r\nALTER TABLE WalmartSalesClean\r\nALTER COLUMN Holiday_Flag Int;\r\n\r\n --filtering for holiday flags and sorting \r\nSELECT Date, SUM(CAST(Weekly_Sales AS FLOAT)) AS Weekly_Sales\r\nFROM WalmartSalesClean \r\nWHERE Holiday_Flag='1'\r\nGROUP BY Date\r\nORDER BY Weekly_Sales DESC;\r\n\r\n\r\n\r\n\r\n\r\nIt seems like Thanksgiving (for all stores) consistently ranks the highest amongst all the holidays. To be more accurate, the total sales per holiday can be extracted.\r\n\r\n\r\nShow SQL code\r\nSELECT \r\nCASE \r\nWHEN Holiday = 02 THEN 'Super Bowl' --changing months to holiday names\r\nWHEN Holiday = 09 THEN 'Labor Day'\r\nWHEN Holiday = 11 THEN 'Thanksgiving'\r\nWHEN Holiday = 12 THEN 'Christmas'\r\nEND AS Holiday, SUM(Weekly_Sales) AS Weekly_Sales\r\n    FROM (  --subquery to have two GROUP BY statements \r\n    SELECT SUBSTRING (DATE, 1, 2) AS Holiday, SUM(CAST(Weekly_Sales AS FLOAT)) AS Weekly_Sales \r\n    FROM WalmartSalesClean \r\n    WHERE Holiday_Flag='1'\r\n    GROUP BY Date\r\n    ) AS temptable \r\nGROUP BY Holiday --Summarizing and reordering data \r\nORDER BY Weekly_Sales DESC\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nDespite Thanksgiving dominating the upper echelons of highest individual store profit, it seems like people spend the most on the Super Bowl! This could be caused by the cultural significance of Thanksgiving, where it “symbolizes intercultural peace, America’s opportunity for newcomers, and the sanctity of home and family”.1 However, I am more inclined to believe that Thanksgiving is typically used as an opportunity to invite all your friends and family and spend the entire day cooking – that means food costs can balloon quickly!\r\nWhich stores have the lowest and highest unemployment rate?\r\n\r\n\r\nShow SQL code\r\n-- highest unemployment rate \r\nSELECT TOP 6 Store, avg(CAST(Unemployment AS decimal)) AS Unemployment, avg(CAST(Weekly_Sales AS decimal)) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Store\r\nORDER BY Unemployment desc, Weekly_Sales desc -- need to use weekly sales as a parameter as stores may have the same unemployment rate\r\n\r\n\r\n\r\nTable 3: Highest Unemployment\r\n\r\n\r\nStore\r\n\r\n\r\nUnemployment\r\n\r\n\r\nWeekly_Sales\r\n\r\n\r\n12\r\n\r\n\r\n13.116483\r\n\r\n\r\n1009001.6\r\n\r\n\r\n28\r\n\r\n\r\n13.116483\r\n\r\n\r\n1323522.2\r\n\r\n\r\n38\r\n\r\n\r\n13.116483\r\n\r\n\r\n385731.7\r\n\r\n\r\n34\r\n\r\n\r\n9.934804\r\n\r\n\r\n966781.6\r\n\r\n\r\n43\r\n\r\n\r\n9.934804\r\n\r\n\r\n633324.7\r\n\r\n\r\n29\r\n\r\n\r\n9.806385\r\n\r\n\r\n539451.4\r\n\r\n\r\n\r\n\r\nShow SQL code\r\n-- lowest unemployment rate\r\nSELECT TOP 6 Store, avg(CAST(Unemployment AS decimal)) AS Unemployment, avg(CAST(Weekly_Sales AS decimal)) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Store\r\nORDER BY Unemployment, Weekly_Sales desc\r\n\r\n\r\n\r\nTable 4: Lowest Unemployment\r\n\r\n\r\nStore\r\n\r\n\r\nUnemployment\r\n\r\n\r\nWeekly_Sales\r\n\r\n\r\n23\r\n\r\n\r\n4.796014\r\n\r\n\r\n1389864.5\r\n\r\n\r\n40\r\n\r\n\r\n4.796014\r\n\r\n\r\n964128.0\r\n\r\n\r\n4\r\n\r\n\r\n5.964692\r\n\r\n\r\n2094713.0\r\n\r\n\r\n8\r\n\r\n\r\n6.091846\r\n\r\n\r\n908749.5\r\n\r\n\r\n9\r\n\r\n\r\n6.099881\r\n\r\n\r\n543980.6\r\n\r\n\r\n5\r\n\r\n\r\n6.295406\r\n\r\n\r\n318011.8\r\n\r\n\r\nInterestingly, there’s not a strong correlation between high unemployment and low weekly sales. I’d expect that places with higher unemployment meant that consumers had less disposable income to spend at Walmart. But, Walmart is known for having super cheap products and consumers could’ve primarily bought inelastic goods and other necessities.\r\nIt could also be that Walmart’s penetration pricing worked too well. Walmart is notorious for significantly impacting the local economy of the neighborhood, positively and negatively. On one hand, low prices means that consumers can afford more things in a one-stop location, and stores near the Walmart get more business due to the influx of foot traffic. On the other, Walmart is known for hiring many workers and paying minimum wage, as well as displacing small businesses due to their low prices, and subsequently, low profit margins. Only large corporations could offer these low margins as they have the financial resources to temporarily suffer short-term losses in hopes of long-term gains. Local businesses simply can’t afford to compete.\r\nEvidently, the positive and negative effects differ depending on the neighborhood that Walmart enters, with this data being a good example of the impacts that Walmart can have.\r\nIt should also be noted that this data comes from 2010 - 2012 – aftermath of the Great Recession. Pre-recession, unemployment was at 4.7% in America. However, between 2010 - 2012, unemployment was at a high of 9.8% in January of 2009 and decreased until reaching a low of 7.7% in November 2012.2\r\nTemperature and Weekly Sales\r\nSurprisingly, the relationship between temperature and weekly sales in this study contradict recent research papers, as there seems there is no correlation between temperature and sales.\r\n\r\n\r\nShow SQL code\r\nSELECT Temperature, avg(Weekly_Sales) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Temperature \r\nORDER BY Weekly_Sales desc\r\n\r\n\r\n\r\n\r\nStudies done by Muro et. al.3 show that natural sunlight has a positive correlation with spending by increasing positive affect. Furthemore, Zwebner and Goldenburg4 say that exposure to physical warmth result in emotional warmth, subsequently increasing product valuation. They also discovered that the ‘optimal’ temperature for increased spending was 78 degrees Fahrenheit. This misattribution of warmth has been called the ‘temperature-premium’ effect.\r\nHowever, both studies test this against specific products, such as cakes, batteries, M&Ms, Gap T shirts. The discrepancy between research and results could be that the objects that were tested in the studies are not common consumer purchases and would not significantly affect weekly sales. Or, the temperature premium may not apply for all products. Furthermore, the studies always utilized artificial heating tools (thermostats or heating pads) within an indoors location. On the other hand, the Walmart data recorded the outdoors temperature, not the temperature within the store. Lastly, the store atmosphere, influenced by indoors lighting, could potentially play an even larger role in customer purchases than weather or temperature. Mitigating the effect of store atmospheres when conducting studies would be crucial.\r\nThere is lots of further research to be done within this topic. Further research could potentially be conducted in the following topics:\r\nDoes the temperature-premium effect apply to all products?\r\nDo natural temperature increases have the same effect as artificial temperature increases?\r\nDoes temperature affect different types of stores (e.g. grocery stores, superstores, cafes) differently?\r\nCPI and Weekly Sales\r\nThe Consumer Price Index (CPI) tracks the weighted average of prices of a metaphorical basket of consumer goods. The goods within this basket are specially selected items that represent the goods and services that a typical US consumer would consume. By tracking the prices of this basket, consumers can understand inflation – the increases of prices resulting in a lack of purchasing power.\r\nAs an example, the 2023 CPI basket contained the following weighted components:\r\n\r\n\r\nCategory\r\n\r\n\r\nPercentage\r\n\r\n\r\nFood\r\n\r\n\r\n16.69\r\n\r\n\r\nShelter\r\n\r\n\r\n29.15\r\n\r\n\r\nHousehold operations, furnishings and equipment\r\n\r\n\r\n13.01\r\n\r\n\r\nClothing and footwear\r\n\r\n\r\n4.55\r\n\r\n\r\nTransportation\r\n\r\n\r\n16.9\r\n\r\n\r\nHealth and personal care\r\n\r\n\r\n5.23\r\n\r\n\r\nRecreation, educaiton and reading\r\n\r\n\r\n10.27\r\n\r\n\r\nAlcoholic beverages, tobacco products, and recreational cannabis\r\n\r\n\r\n4.2\r\n\r\n\r\nTotal\r\n\r\n\r\n100\r\n\r\n\r\nWe can also see the seasonally adjusted Canadian CPI5 since 2022.\r\n\r\n\r\nDate\r\n\r\n\r\nCPI\r\n\r\n\r\n2024/04\r\n\r\n\r\n160.2\r\n\r\n\r\n2024/01\r\n\r\n\r\n159.3\r\n\r\n\r\n2023/09\r\n\r\n\r\n158.6\r\n\r\n\r\n2023/05\r\n\r\n\r\n156.2\r\n\r\n\r\n2023/01\r\n\r\n\r\n154.9\r\n\r\n\r\n2022/09\r\n\r\n\r\n152.8\r\n\r\n\r\n2022/05\r\n\r\n\r\n151.2\r\n\r\n\r\n2022/01\r\n\r\n\r\n146.3\r\n\r\n\r\nThere is a clear relationship of the CPI increasing as time goes on – an indicator of inflation.\r\nHowever, we can compare the change in prices in the same time period:\r\n\r\n\r\nDate\r\n\r\n\r\nCPI\r\n\r\n\r\nFuel Prices (¢/Litre)\r\n\r\n\r\n2024/04\r\n\r\n\r\n160.2\r\n\r\n\r\n169.76\r\n\r\n\r\n2024/01\r\n\r\n\r\n159.3\r\n\r\n\r\n145.90\r\n\r\n\r\n2023/09\r\n\r\n\r\n158.6\r\n\r\n\r\n162.45\r\n\r\n\r\n2023/05\r\n\r\n\r\n156.2\r\n\r\n\r\n160.62\r\n\r\n\r\n2023/01\r\n\r\n\r\n154.9\r\n\r\n\r\n153.48\r\n\r\n\r\n2022/09\r\n\r\n\r\n152.8\r\n\r\n\r\n154.09\r\n\r\n\r\n2022/05\r\n\r\n\r\n151.2\r\n\r\n\r\n183.99\r\n\r\n\r\n2022/01\r\n\r\n\r\n146.3\r\n\r\n\r\n153.88\r\n\r\n\r\nDuring this time, the average prices of regular unleaded gasoline in Canada do not follow the same pattern of increasing as time goes on.\r\nThis is because of the price elasticity of demand for fuel. Price elasticity is the percentage change in the quantity demanded of a good or service divided by the percentage change in price and shows how sensitive an item’s demand is to changes in price. For example, a demand elasticity of -1 would mean that for every 1% increase in price, the demand of a good would fall by 1%. An elasticity of 0 would mean that the demand does not change, even if the price changes.\r\nFuel is an inelastic good, meaning that the change in demand is quite small, relative to the change in price. This is because fuel is a difficult product to substitute – gas is most likely the only option you have to fuel your car– and is necessary for daily transportation.\r\nAlthough fuel has always been comparatively inelastic good, recent research shows that fuel is more price elastic than we thought. Previously, a widely cited study by Hughes et. al. in 2008 claimed that the price elasticity for gas was between -0.03 and -0.08, meaning that demand barely changes when prices increase. However, in 2017, Coglianese et. al. found that the price elasticity of gasoline was -0.37, with their findings being corroborated by two other studies.\r\nThe errors in previous studies are likely caused by flawed estimation methods and/or questionable data. However, larger societal shifts may also play a part, where major car companies are pushing more fuel-efficient or electric vehicles and more consumers are using public transit as cities become more urbanized and transit infrastructure improves.6\r\nHence, one may conclude that an increase in CPI and fuel prices could result in more Walmart sales. With inflation reducing consumer purchasing power, consumers tend to spend less as their necessities have increased in price. Subsequently, they would be likely to go to Walmart – a store known for having low prices – to shop, attempting to keep their spending low, resulting in increased sales for Walmart. A similar effect could occur with the rise of fuel prices. Since fuel has inelastic demand, consumers would need to spend more money on fuel, resulting in less money being spent on other necessities. Hence, consumers would likely opt for cheaper products and shop at Walmart compared to more expensive stores.\r\nHowever, in regard to this data set, the following relationships are found.\r\n\r\n\r\n\r\nThis data set does not contain CPI values between ~143 to ~ 180. It is likely because the CPI of stores were never in this range, however, the possibility of having missing data should be considered.\r\nCPI also seems to be separated into 4 main clusters:\r\n125 to 143, which have average sales of 1.1 million.\r\n180 to 190, which have average sales of 1.5 million.\r\n189 to 200, which have average sales of 0.9 million.\r\n200 and above, with average sales generally being scattered around 1 million.\r\nAlthough there doesn’t seem to be a correlation between CPI and weekly sales, it seems like stores with the same CPI tend to perform similarly.\r\n\r\n\r\n\r\nThere is also no correlation between fuel price and total sales. However, this graph does have a strange divide, where stores either make ~0.5 million, or ~0.7 million and above. The cause of this discrepancy is unknown, as it happens a various fuel price points.\r\nIt’s clear that the trends do not follow the hypothesized positive relationship between these variables and weekly sales. The most probable answer to this is discrepancy is that the economic changes were not enough to shift consumer spending behavior. For example, consumers may not switch to a different store because it’s more convenient for them to go (or not go) to Walmart. Furthermore, economics assumes that all consumers are rational as given a large enough sample, the macro trends of consumer spending will gravitate towards rational behavior. However, the sample within this data set may be too small to observe rational trends. A further extension could be diving into behavioral economics and how it affects this data set.\r\nSample Pearson Correlation\r\nWe can also use statistics to back up these claims by checking the correlation between weekly sales and other factors. This gives us insight into the relationship between each of the variables.\r\nThe sample Pearson correlation coefficient was used to determine whether there was a linear correlation between the two sets of data. The coefficient ranges from \\(-1\\) \\(\\le\\) \\(r_{X,Y}\\) \\(\\le\\) \\(1\\), where \\(-1\\) means a perfect negative linear relationship (as weekly sales go up, the other variable goes down) and \\(1\\) means a perfect positive linear relationship (as weekly sales go up, the other variable goes up.)\r\nSubsequently:\r\nif \\(r_{X,Y}\\) \\(\\ge\\) \\(0\\), the variables have a positive relationship.\r\n\\(r_{X,Y}\\) \\(\\le\\) \\(0\\), the variables have a negative relationship.\r\nBased on the above analysis, the following relationships are predicted:\r\nWeekly sales and holiday: \\(r_{X,Y}\\) \\(\\ge\\) \\(0\\)\r\nWeekly sales and unemployment: \\(r_{X,Y}\\) \\(\\le\\) \\(0\\)\r\nWeekly sales and CPI: \\(r_{X,Y}\\) \\(\\ge\\) \\(0\\)\r\nWeekly sales and fuel price: \\(r_{X,Y}\\) \\(\\ge\\) \\(0\\)\r\nWeekly sales and temperature: \\(r_{X,Y}\\) \\(\\ge\\) \\(0\\)\r\nThe following formula will be used:\r\n\\(r_{xy}={\\frac {n\\sum x_{i}y_{i}-\\sum x_{i}\\sum y_{i}}{\\sqrt{(n\\sum x^2 - \\sum x \\sum x)(n\\sum y^2 - \\sum y \\sum y)}}}\\)\r\nwhere \\(x\\) is Weekly_Sales, and \\(y\\) the variable we want to test the correlation of.\r\nThe sample Pearson correlation coefficient calculated is:\r\n\r\n\r\nShow SQL code\r\n-- calculating the Pearson coefficient for weekly sales and unemployment. \r\n-- Replacing the y value (in this case, unemployment) with the other factors \r\n-- would yield the coefficient for that specific factor \r\n\r\nWITH rdata AS (\r\nSELECT CAST(Unemployment AS decimal) AS Unemployment, CAST(Weekly_Sales AS decimal) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\n),\r\n\r\nrawdata AS ( -- calculating expectation \r\nSELECT Unemployment AS x, Weekly_Sales AS y, Unemployment*Weekly_Sales AS xy, Unemployment*Unemployment AS xsquared, \r\nWeekly_Sales*Weekly_Sales AS ysquared   \r\nFROM rdata\r\n),\r\n\r\npdata AS ( -- reorganizing data \r\nSELECT SUM(x) AS sumx, SUM(y) AS sumy, SUM(xy) as sumxy, SUM(xsquared) as sumx2, SUM(ysquared) as sumy2, COUNT(x) as n\r\nFROM rawdata\r\n)\r\n\r\n--- covariance(xy) / (std. dev. x) * (std. dev. y)\r\nSELECT (n*sumxy - sumx * sumy) / (sqrt((n*sumx2 - sumx*sumx)*(n*sumy2 - sumy*sumy))) AS \"Pearson's Correlation\"\r\nFROM pdata\r\n\r\n\r\n\r\n\r\n\r\nPoint-Biserial Correlation Coefficient\r\nFor Holiday_Flag, we need to use a point-biserial correlation coefficient instead of the Pearson correlation coefficent. This is because Holiday_Flag is a dichotomous variable (values can only be 1 or 0 to symbolize yes/no) compared Weekly Sales, which is not a dichotomous variable (values can be any number).\r\nAlthough you can use Pearson’s with dichotomous variables, the usefulness of the correlation would be debatable since it’s not meant to be utilized with dichotomous variables. Hence, it’s best to use a point-biserial, as it is equivalent to the Pearson correlation coefficient.7\r\nWe will be using the following formula:\r\n\\({r_{pb}={\\frac {M_{1}-M_{0}}{s_{n}}}{\\sqrt {\\frac {n_{1}n_{0}}{n^{2}}}}}\\)\r\nwhere:\r\n\\(M_1\\) = Mean weekly sales when the Holiday_Flag = 1\\(M_0\\) = Mean weekly sales when the Holiday_Flag = 0\\(s_n\\) = Standard deviation of weekly sales\\(n_1\\) = Number of data points where Holiday_Flag = 1\\(n_2\\) = Number of data points where Holiday_Flag = 0\\(n\\) = Total number of data points in the sample\r\n\r\n\r\nShow SQL code\r\n\r\n--grabbing avg weekly sales for holiday / no holiday\r\nWITH meanflag AS ( \r\nSELECT Holiday_Flag, avg(CAST(Weekly_Sales AS decimal)) AS Avg_Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Holiday_Flag\r\n), \r\n\r\n-- grabbing number of holiday / no holiday days\r\ncountflag AS ( \r\nSELECT Holiday_Flag, count(Holiday_Flag) AS n_Holiday_Flag\r\nFROM WalmartSalesClean\r\nGROUP BY Holiday_Flag\r\n),\r\n\r\n-- combining it into one table\r\njoinmeancount AS ( \r\nSELECT meanflag.Holiday_Flag, meanflag.Avg_Weekly_Sales, countflag.n_Holiday_Flag\r\nFROM meanflag\r\nINNER JOIN countflag\r\n    ON countflag.Holiday_Flag = meanflag.Holiday_Flag\r\n),\r\n\r\n-- adding standard deviation and total count of weekly sales\r\njoinstdn AS ( \r\nSELECT STDEV(CAST(Weekly_Sales AS decimal)) AS sn, count(Weekly_Sales) as n, \r\n(SELECT n_Holiday_Flag FROM joinmeancount WHERE Holiday_Flag = 1) AS n1, \r\n(SELECT n_Holiday_Flag FROM joinmeancount WHERE Holiday_Flag = 0) AS n0, \r\n(SELECT Avg_Weekly_Sales FROM joinmeancount WHERE Holiday_Flag = 1) AS m1,\r\n(SELECT Avg_Weekly_Sales FROM joinmeancount WHERE Holiday_Flag = 0) AS m0\r\nFROM WalmartSalesClean\r\n)\r\n\r\n-- calculating correlation, need to convert into floats for division\r\nSELECT ((m1-m0)/sn) * SQRT((CAST(n1 * n0 AS FLOAT)) / (CAST(n * n AS FLOAT))) AS r_pb \r\nFROM joinstdn\r\n\r\nwhich results in an \\(r_{pb}\\) value of ~ 0.037 – a slight positive correlation.\r\n\r\n\r\n\r\n\r\nThe correlation coefficient matches with the data observed within the tables in charts.\r\nGeographic Data\r\nUsing the information in the data set, it may be possible to make educated guesses regarding the geographic region of the stores.\r\nIn 2010, Walmart was open in the following countries:\r\nUS\r\nMexico\r\nCanada\r\nUK\r\nChina\r\nSouth Africa\r\nArgentina\r\nBrazil\r\nHence, the unemployment rate data for each store could be corroborated against country-wide unemployment data from the Organisation for Economic Co-operation and Development (OECD) and World Bank Group to determine which region the store could likely fall into.\r\nAccording to past records:\r\n\r\n\r\nCountry\r\n\r\n\r\nUnemployment\r\n\r\n\r\nSouth Africa\r\n\r\n\r\n45.500\r\n\r\n\r\nUS\r\n\r\n\r\n9.610\r\n\r\n\r\nBrazil\r\n\r\n\r\n8.400\r\n\r\n\r\nCanada\r\n\r\n\r\n8.175\r\n\r\n\r\nUK\r\n\r\n\r\n7.870\r\n\r\n\r\nArgentina\r\n\r\n\r\n7.700\r\n\r\n\r\nMexico\r\n\r\n\r\n5.380\r\n\r\n\r\nChina\r\n\r\n\r\n4.500\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nhttps://www.britannica.com/topic/Thanksgiving-Day↩︎\r\nhttps://www.bls.gov/charts/employment-situation/civilian-unemployment-rate.htm↩︎\r\nhttps://www.ualberta.ca/business/media-library/centres/sor/documents/murrayetal2010-theeffectofweatheronconsumerspending.pdf↩︎\r\nhttps://web2-bschool.nus.edu.sg/wp-content/uploads/media_rp/publications/zLb1d1490932501.pdf↩︎\r\nThis CPI score eliminates seasonal movements, such as events caused by climate and holidays.↩︎\r\nhttps://www150.statcan.gc.ca/n1/daily-quotidien/240220/dq240220d-eng.htm↩︎\r\nhttps://en.wikipedia.org/wiki/Point-biserial_correlation_coefficient↩︎\r\n",
      "last_modified": "2024-07-07T14:36:25-04:00"
    }
  ],
  "collections": []
}
